(this.webpackJsonpmeetify=this.webpackJsonpmeetify||[]).push([[0],{146:function(e,t,a){},147:function(e,t,a){},148:function(e,t,a){},149:function(e,t,a){},150:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(13),o=a.n(c);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=a(6),l=a(214),s=a(10),u=a(188),m=a(205),d=a(107),f=r.a.createContext({alert:null,addAlert:function(){},removeAlert:function(){}});function p(e){var t=e.children,a=Object(n.useState)(null),c=Object(i.a)(a,2),o=c[0],l=c[1],s={alert:o,addAlert:Object(n.useCallback)((function(e){var t=e.title,a=e.text,n=e.severity,r=e.type;return l({title:t,text:a,severity:n,type:r})}),[]),removeAlert:Object(n.useCallback)((function(){return l(null)}),[])};return r.a.createElement(f.Provider,{value:s},t)}function h(){var e=Object(n.useContext)(f);return{alert:e.alert,addAlert:e.addAlert,removeAlert:e.removeAlert}}var b=a(211),g=a(194),v=a(184),y=a(50);function E(e){return r.a.createElement(v.a,Object.assign({color:"error",badgeContent:r.a.createElement(y.a,{variant:"body1"},r.a.createElement("strong",null,"!"))},e))}var j=a(21),O=a(11),k=a.n(O),w=a(19),C=a(22),x=a(20),N=a.n(x),S=(a(97),a(98)),I=function(e){var t=Object(j.a)({},e);for(var a in t)null!==t[a]&&void 0!==t[a]||delete t[a];return t},M=function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.toLowerCase())&&e.length<=254},T=function(e){return/(.){10,128}$/.test(e)},P=function(e){return/^([a-zA-Z0-9\-_.])*$/.test(e)&&e.length>=5&&e.length<=128};N.a.defaults.withCredentials=!0,N.a.defaults.xsrfHeaderName="X-CSRFToken";var D="http://50.19.8.68",B={login:["user","login"],logout:["user","logout"],signup:["user","signup"],profile:["user","{id}","profile"],linkSpotifyAccount:["user","link-account"],checkSpotifyLinked:["user","is-linked"],getPotentialMatches:["matching","potential-matches"],getAcceptedMatches:["matching","accepted-matches"],rejectMatch:["matching","reject-match"],acceptMatch:["matching","accept-match"],messages:["chat","messages?match={match_id}"],userSongIntersection:{byUserId:["intersection","liked-songs"],byUsername:["intersection","liked-songs-by-username"]},syncProfilePic:["user","update-profile-pic"]},A=null,R=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return e+(e.endsWith("/")?"":"/")+a.join("/")},U=function(){var e=Object(C.a)(k.a.mark((function e(t){var a,n,r,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.username,t.email,n=t.password,r=R.apply(void 0,[D].concat(Object(w.a)(B.login))),c={Username:a,Password:n},e.abrupt("return",N.a.post(r,c).then(function(){var e=Object(C.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.status>=300)){e.next=4;break}throw Error("Received status ".concat(t.status," from server"));case 4:if(t.data){e.next=8;break}throw Error("Received no data from server");case 8:return e.abrupt("return",{username:t.data.username,userId:t.data.id});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw e})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(C.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=R.apply(void 0,[D].concat(Object(w.a)(B.logout))),e.abrupt("return",N.a.get(t).then(function(){var e=Object(C.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(204!==t.status){e.next=4;break}return e.abrupt("return");case 4:throw Error("Received status ".concat(t.status," from server"));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw e})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(C.a)(k.a.mark((function e(t){var a,n,r,c,o,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.username,n=t.email,r=t.password,P(a)){e.next=3;break}throw Error("Invalid registration username: ".concat(n));case 3:if(M(n)){e.next=5;break}throw Error("Invalid registration email: ".concat(n));case 5:if(T(r)){e.next=7;break}throw Error("Invalid registration email");case 7:return c=R.apply(void 0,[D].concat(Object(w.a)(B.signup))),o=n.split("@")[0],i={Username:a,Email:n,Password:r,DisplayName:o,ZipCode:null,ProfilePicURL:null},e.abrupt("return",N.a.post(c,i).then((function(e){return{}})).catch((function(e){if(!e.hasOwnProperty("response"))throw e;if(!e.response){var t=Error("Please check your connection and try again.");throw t.name="CouldNotConnect",t}if(409===e.response.status)throw Error("Could not create account: That username is already taken!")})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(C.a)(k.a.mark((function e(t){var a,n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.userId,n=R.apply(void 0,[D].concat(Object(w.a)(B.profile))),r=n.replace("{id}",a),e.abrupt("return",N.a.get(r).then((function(e){if(e.status>=300)throw Error("Received status ".concat(e.status," from server"));if(e.data)return{displayName:e.data.DisplayName,profilePicUrl:e.data.ProfilePicURL,description:e.data.Description};throw Error("Received no profile data from server")})).catch((function(e){throw e})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(C.a)(k.a.mark((function e(t){var a,n,r,c,o,i,l,s;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.userId,n=t.changes,r=R.apply(void 0,[D].concat(Object(w.a)(B.profile))),c=r.replace("{id}",a),o=n.description,i=n.displayName,l=n.profilePicUrl,s=I({Description:o,DisplayName:i,ProfilePicURL:l}),e.abrupt("return",N.a.post(c,s).then((function(e){if(e.status>=300)throw Error("Received status ".concat(e.status," from server"));if(e.data)return{displayName:e.data.DisplayName,profilePicUrl:e.data.ProfilePicURL,description:e.data.Description};throw Error("Received no profile data from server")})).catch((function(e){if(!e.hasOwnProperty("response"))throw e;if(!e.response){var t=Error("Please check your connection and try again.");throw t.name="CouldNotConnect",t}if(401===e.response.status)throw Error("Could not update. Please login and try again.")})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(C.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.userId,a=R.apply(void 0,[D].concat(Object(w.a)(B.linkSpotifyAccount))),e.abrupt("return",N.a.get(a).then((function(e){if(e.status>=300)throw Error("Received status ".concat(e.status," from server"));if(e.data)return{url:e.data};throw Error("Received no Spotify link URL from server")})).catch((function(e){throw e})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(C.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.userId,a=R.apply(void 0,[D].concat(Object(w.a)(B.checkSpotifyLinked))),e.abrupt("return",N.a.get(a).then((function(e){if(e.status>=300)throw Error("Received status ".concat(e.status," from server"));if(e.data&&null!==e.data.IsLinked&&void 0!==e.data.IsLinked)return{spotifyLinked:e.data.IsLinked};throw Error("Received no Spotify link check from server")})).catch((function(e){throw e})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G={start:function(){var e=Object(C.a)(k.a.mark((function e(t){var a,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.userId,clearInterval(A),n=0,100,2e3,e.abrupt("return",new Promise((function(e,t){A=setInterval((function(){console.log("Checking if Spotify linked..."),A||t("Cancelled"),q({userId:a}).then((function(a){var r=a.spotifyLinked;!0===r?(clearInterval(A),e({spotifyLinked:r})):(n+=1)>100&&(clearInterval(A),t("Timed out"))})).catch((function(e){clearInterval(A),t(e)}))}),2e3)})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),stop:function(){clearInterval(A)}},H=function(e){return N.a.get(e).then(function(){var e=Object(C.a)(k.a.mark((function e(t){var a,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.status>=300)){e.next=4;break}throw Error("Received status ".concat(t.status," from server"));case 4:if(t.data){e.next=8;break}throw Error("Received no match from server");case 8:return e.next=10,Promise.all(t.data.map((function(e){return F({userId:e.matched_with})})));case 10:return a=e.sent,e.next=13,Promise.all(t.data.map((function(e){return Y({userId:e.matched_with})})));case 13:return n=e.sent,e.abrupt("return",t.data.map((function(e,t){return{userId:e.matched_with,matchId:e.match_id,profile:a[t],songs:n[t],messages:null}})));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw e}))},Y=function(e){var t=e.userId,a=e.username,n=null!=t?"byUserId":"byUsername",r=R.apply(void 0,[D].concat(Object(w.a)(B.userSongIntersection[n]))),c=I({target_user_id:t,target_username:a});return N.a.post(r,c).then((function(e){if(e.status>=300)throw Error("Received status ".concat(e.status," from server"));if(e.data)return Object.keys(e.data).map((function(t){return Object(j.a)(Object(j.a)({},e.data[t]),{},{songId:t})}));throw Error("Received no data from server")})).catch((function(e){throw e}))},K=function(){var e=R.apply(void 0,[D].concat(Object(w.a)(B.syncProfilePic)));return N.a.get(e).then((function(e){if(e.status>=300)throw Error("Received status ".concat(e.status," from server"))})).catch((function(e){throw e}))},Z=a(32),V={loggedIn:!1,username:"",userId:-1,spotify:{linked:!1},profile:{displayName:"",description:"",profilePicUrl:""}},$=Object(Z.b)({name:"account",initialState:Object(j.a)(Object(j.a)({},V),{},{spotify:Object(j.a)({},V.spotify),profile:Object(j.a)({},V.profile)}),reducers:{setLoggedIn:function(e,t){e.loggedIn=t.payload},setUsername:function(e,t){e.username=t.payload},setUserId:function(e,t){e.userId=t.payload},setProfile:function(e,t){e.profile=t.payload},setSpotifyLinked:function(e,t){e.spotify.linked=t.payload},resetAccountData:function(e,t){Object(j.a)(Object(j.a)({},V),{},{spotify:Object(j.a)({},V.spotify),profile:Object(j.a)({},V.profile)})}}}),J=$.actions,X=J.setLoggedIn,Q=J.setUsername,ee=J.setUserId,te=J.setProfile,ae=J.setSpotifyLinked,ne=J.resetAccountData,re=$.reducer,ce=a(193),oe=a(195),ie=a(213),le=a(215),se=a(189),ue=a(190),me=a(191),de=a(192),fe=Object(u.a)((function(e){return{dialogContent:{maxWidth:600,minWidth:600,paddingTop:e.spacing(2)},cancelButton:{color:e.palette.error.light},submitButton:{color:e.palette.primary.light}}}));function pe(e){var t=fe(),a=e.open,n=e.submitButtonDisabled,c=e.cancelButtonDisabled,o=e.onClose,i=e.onCancel,l=e.onSubmit,s=e.title,u=e.submitButtonText,m=e.cancelButtonText,d=e.children;return r.a.createElement(le.a,{open:a,onClose:function(){return o&&o()},maxWidth:"lg"},r.a.createElement(se.a,{position:"static"},r.a.createElement(ue.a,null,s||"Form Dialog")),r.a.createElement(me.a,{className:t.dialogContent},d),r.a.createElement(de.a,null,r.a.createElement(ce.a,{onClick:function(){return i&&i()},className:t.cancelButton,disabled:c},m||"Cancel"),r.a.createElement(ce.a,{onClick:function(){return l&&l()},className:t.submitButton,disabled:n},u||"Submit")))}var he=Object(u.a)((function(e){return{dialogContent:{maxWidth:600,minWidth:600,paddingTop:e.spacing(2)},editableMargin:{marginTop:e.spacing(2)},spotifyLink:{textDecoration:"none"}}}));function be(e){var t=e.open,a=e.onCancel,c=e.onSuccess,o=he(),l=Object(s.b)(),u=h().addAlert,m=Object(s.c)((function(e){return e.account.userId})),d=Object(s.c)((function(e){return e.account.spotify.linked})),f=Object(n.useState)(""),p=Object(i.a)(f,2),b=p[0],g=p[1],v=Object(n.useState)(""),E=Object(i.a)(v,2),j=E[0],O=E[1];Object(n.useEffect)((function(){g(""),O(""),t&&z({userId:m}).then((function(e){var t=e.url;g(t)})).catch((function(e){var t="Can't link:";e&&e.message?O("".concat(t," ").concat(e.message)):O("string"===typeof e?"".concat(t," ").concat(e):"".concat(t," Unknown error occurred"))}))}),[t,m]);var k=function(){G.stop(),d?c&&c():a&&a()};return r.a.createElement(pe,{open:t,title:"Spotify Account Link",submitButtonText:"Continue",submitButtonDisabled:!d,cancelButtonDisabled:d,onSubmit:function(){c()},onClose:k,onCancel:k},r.a.createElement(y.a,{variant:"body1"},"To use ",r.a.createElement("strong",null,"Meetify"),", we will need some basic info from your Spotify account.",r.a.createElement("br",null),r.a.createElement("em",null,"(You can always do this later from within the app!)")),j&&r.a.createElement(ie.a,{className:o.editableMargin,severity:"error"},j),!j&&r.a.createElement("a",{className:o.spotifyLink,href:b,target:"_blank",rel:"noreferrer"},r.a.createElement(ce.a,{fullWidth:!0,onClick:function(){G.start({userId:m}).then((function(e){var t=e.spotifyLinked;return l(ae(t)),u({severity:"success",text:"Your Spotify account has been linked! You can now use the Meetify services.",type:"snackbar"}),K().then((function(){return F({userId:m})})).then((function(e){l(te(e))})).catch((function(e){console.error(e),u({severity:"warning",text:"Your Spotify account has been linked, but we could not retrieve your profile picture.",type:"snackbar"})}))})).catch((function(e){console.error(e),u({severity:"error",text:"Spotify linkage timed out; please try again!",type:"snackbar"})}))},className:o.editableMargin,variant:"outlined",color:"primary",disabled:!b||d},!b&&r.a.createElement(oe.a,{size:26,thickness:5})||d&&"Complete!"||"Link Account")))}var ge=Object(Z.b)({name:"account",initialState:{username:"",songs:[]},reducers:{setIntersectUsername:function(e,t){e.username=t.payload},setSongs:function(e,t){e.songs=t.payload},resetIntersectData:function(e){({username:"",songs:[]})}}}),ve=ge.actions,ye=ve.setIntersectUsername,Ee=ve.setSongs,je=ve.resetIntersectData,Oe=ge.reducer,ke=Object(Z.b)({name:"matches",initialState:{matches:[]},reducers:{setMatches:function(e,t){e.matches=t.payload},clearMatches:function(e){e.matches=[]},setMessages:function(e,t){var a=t.payload,n=a.matchId,r=a.messages;e.matches=e.matches.map((function(e){return e.matchId!==n?e:Object(j.a)(Object(j.a)({},e),{},{messages:r})}))},resetMatchesData:function(e){e.matches=[]}}}),we=ke.actions,Ce=we.setMatches,xe=(we.clearMatches,we.setMessages),Ne=we.resetMatchesData,Se=ke.reducer,Ie=Object(Z.b)({name:"meet",initialState:{matches:[]},reducers:{setMatches:function(e,t){e.matches=t.payload},clearMatches:function(e){e.matches=[]}}}),Me=Ie.actions,Te=Me.setMatches,Pe=Me.clearMatches,De=Ie.reducer;function Be(e){var t=Object(s.b)(),a=h().addAlert,n=e.open,c=e.onCancel,o=e.onSuccess;return r.a.createElement(pe,{open:n,title:"Account Logout",submitButtonText:"Logout",onSubmit:function(){W().then((function(){t(X(!1)),t(ne()),t(je()),t(Ne()),t(Pe()),o&&o()})).catch((function(e){console.error(e),a({type:"snackbar",severity:"error",text:"Could not log out. Please try again."})}))},onClose:function(){c&&c()},onCancel:function(){c&&c()}},r.a.createElement(y.a,{variant:"body1"},"Are you sure you want to log out?"))}var Ae=a(99),Re=a.n(Ae),Ue=a(70),We=a.n(Ue),Le=a(108);function Fe(e){return r.a.createElement(Le.a,Object.assign({},e,{viewBox:"0 0 427.652 427.652"}),r.a.createElement("path",{style:{fill:"#00D95F"},d:"M213.826,0C95.733,0,0,95.733,0,213.826s95.733,213.826,213.826,213.826 s213.826-95.733,213.826-213.826S331.919,0,213.826,0z M306.886,310.32c-2.719,4.652-7.612,7.246-12.638,7.247 c-2.506,0-5.044-0.645-7.364-2c-38.425-22.456-82.815-26.065-113.295-25.138c-33.763,1.027-58.523,7.692-58.769,7.76 c-7.783,2.126-15.826-2.454-17.961-10.236c-2.134-7.781,2.43-15.819,10.209-17.962c1.116-0.307,27.76-7.544,64.811-8.766 c21.824-0.72,42.834,0.801,62.438,4.52c24.83,4.71,47.48,12.978,67.322,24.574C308.612,294.393,310.96,303.349,306.886,310.32z M334.07,253.861c-3.22,5.511-9.016,8.583-14.97,8.584c-2.968,0-5.975-0.763-8.723-2.369c-45.514-26.6-98.097-30.873-134.2-29.776 c-39.994,1.217-69.323,9.112-69.614,9.192c-9.217,2.515-18.746-2.906-21.275-12.124c-2.528-9.218,2.879-18.738,12.093-21.277 c1.322-0.364,32.882-8.937,76.77-10.384c25.853-0.852,50.739,0.949,73.96,5.354c29.412,5.58,56.241,15.373,79.744,29.108 C336.115,234.995,338.897,245.603,334.07,253.861z M350.781,202.526c-3.641,0-7.329-0.936-10.7-2.906 c-108.207-63.238-248.572-25.643-249.977-25.255c-11.313,3.117-23.008-3.527-26.124-14.839 c-3.117-11.312,3.527-23.008,14.839-26.124c1.621-0.447,40.333-10.962,94.166-12.737c31.713-1.044,62.237,1.164,90.72,6.567 c36.077,6.844,68.987,18.856,97.815,35.704c10.13,5.92,13.543,18.931,7.623,29.061C365.193,198.757,358.084,202.526,350.781,202.526 z"}))}var _e=Object(u.a)((function(e){return{root:{backgroundColor:e.palette.background.default,height:"100%",width:"100%",display:"flex",flexDirection:"column"},tabs:{flexGrow:1},buttons:{display:"flex",flexDirection:"row",padding:e.spacing(1)},divider:{borderColor:e.palette.text.disabled},logoutButton:{color:e.palette.error.light}}}));function ze(e){var t=_e(),a=h().addAlert,c=e.children,o=e.activeIndex,l=Object(s.c)((function(e){return e.account.spotify.linked})),u=Object(n.useState)(!1),m=Object(i.a)(u,2),f=m[0],p=m[1],v=Object(n.useState)(!1),y=Object(i.a)(v,2),j=y[0],O=y[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:t.root,square:!0},r.a.createElement(b.a,{className:t.tabs,orientation:"vertical",value:o||0},c),r.a.createElement("div",null,r.a.createElement("hr",{className:t.divider})),r.a.createElement("div",{className:t.buttons},r.a.createElement(g.a,{className:t.logoutButton,onClick:function(){O(!0)}},r.a.createElement(Re.a,null)),r.a.createElement(g.a,{onClick:function(){l?a({severity:"info",text:"Spotify account already linked!",type:"snackbar"}):p(!0)}},r.a.createElement(E,{overlap:"circle",invisible:l},r.a.createElement(Fe,null))),r.a.createElement(g.a,null,r.a.createElement(We.a,null)))),r.a.createElement(be,{open:f,onSuccess:function(){p(!1)},onCancel:function(){p(!1)}}),r.a.createElement(Be,{open:j,onSuccess:function(){O(!1),a({severity:"success",text:"You are now logged out from Meetify.",type:"snackbar"})},onCancel:function(){O(!1)}}))}var qe=a(197),Ge=a(210),He=Object(u.a)((function(e){return{dialogContent:{maxWidth:600,minWidth:600,paddingTop:e.spacing(2)},editableMargin:{marginTop:e.spacing(2)},hintText:{color:e.palette.text.hint}}}));function Ye(e){var t=e.open,a=e.onCancel,c=e.onSuccess,o=He(),l=Object(n.useState)(""),s=Object(i.a)(l,2),u=s[0],m=s[1],d=Object(n.useState)(""),f=Object(i.a)(d,2),p=f[0],b=f[1],g=Object(n.useState)(""),v=Object(i.a)(g,2),E=v[0],j=v[1],O=Object(n.useState)(""),k=Object(i.a)(O,2),w=k[0],C=k[1],x=Object(n.useState)(!1),N=Object(i.a)(x,2),S=N[0],I=N[1],D=Object(n.useState)(!1),B=Object(i.a)(D,2),A=B[0],R=B[1],U=Object(n.useState)(!1),W=Object(i.a)(U,2),F=W[0],_=W[1],z=Object(n.useState)(!1),q=Object(i.a)(z,2),G=q[0],H=q[1],Y=h().addAlert,K=S&&!P(u)&&"Username must be at least 5 letters, numbers, and/or allowed symbols",Z=A&&!M(p)&&"Invalid email",V=F&&!T(E)&&"Password must be at least 10 characters",$=G&&E!==w&&"Passwords must match",J=!u||!p||!E||!w||!!K||!!Z||!!V||!!$;Object(n.useEffect)((function(){!0===t&&(m(""),b(""),j(""),C(""),I(!1),R(!1),_(!1),H(!1))}),[t]);return r.a.createElement(pe,{open:t,title:"Create Account",submitButtonText:"Create Account",submitButtonDisabled:J,onSubmit:function(){L({username:u,email:p,password:E}).then((function(){c&&c()})).catch((function(e){var t;Y({text:e.message||e,title:e.name&&(t=e.name,t.match(/[A-Z][a-z]+/g).join(" "))||null,type:"dialog",severity:"error"}),e.name&&"CouldNotConnect"===e.name||(j(""),C(""),_(!1),H(!1))}))},onClose:function(){return a&&a()},onCancel:function(){return a&&a()}},r.a.createElement(y.a,{variant:"body1"},"Welcome to ",r.a.createElement("strong",null,"Meetify"),"! Before you start meeting people, we just need some basic info..."),r.a.createElement(Ge.a,{className:o.editableMargin,label:"Username",variant:"outlined",error:!!K,helperText:K,fullWidth:!0,required:!0,value:u,onChange:function(e){m(e.target.value),I(!0)},inputProps:{spellCheck:!1}}),r.a.createElement(Ge.a,{className:o.editableMargin,label:"Email Address",variant:"outlined",error:!!Z,helperText:Z,fullWidth:!0,required:!0,value:p,onChange:function(e){b(e.target.value),R(!0)},inputProps:{spellCheck:!1}}),r.a.createElement(y.a,{variant:"body1",className:"".concat(o.editableMargin," ").concat(o.hintText)},"We don't have restrictions on what's in your password, but ",r.a.createElement("strong",null,"make it long!")," Password length is what really keeps you secure.",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("strong",null,"Our tip:")," Try a unique but easy-to-remember sentence, such as:",r.a.createElement("br",null),r.a.createElement("em",null,'"Timetomeet42greatnewfriends!"')),r.a.createElement(Ge.a,{className:o.editableMargin,label:"Password",type:"password",variant:"outlined",error:!!V,helperText:V,fullWidth:!0,required:!0,value:E,onChange:function(e){j(e.target.value),_(!0)}}),r.a.createElement(Ge.a,{className:o.editableMargin,label:"Confirm Password",type:"password",variant:"outlined",error:!!$,helperText:$,fullWidth:!0,required:!0,value:w,onChange:function(e){C(e.target.value),H(!0)}}))}function Ke(e){return r.a.createElement(oe.a,{size:24,thickness:4.6})}var Ze=a(104),Ve=a(75),$e=a.n(Ve),Je=a(74),Xe=a.n(Je),Qe=Object(Ze.a)({palette:{type:"dark",primary:{light:"#4ac776",main:"#1DB954",dark:"#14813a",contrastText:"#fff"},secondary:{light:Xe.a[300],main:Xe.a[400],dark:Xe.a[500],contrastText:"#000"},gray:{light:"#474343",main:"#191414",dark:"#110e0e",contrastText:"#000"},error:{light:$e.a[300],main:$e.a[400],dark:$e.a[500]}},tile:{height:"135px"},images:{squareImageHeight:"150px",cardImageHeight:"100px"}}),et={deg:"90deg"};Qe.getGradient=function(e,t){t||(t={});var a=Object.assign({},et,t);return 0===e.length?"rgba(0, 0, 0, 0)":1===e.length?e[0]:2===e.length?"linear-gradient(".concat(a.deg,", ").concat(e[0]," 16%, ").concat(e[1]," 77%"):"linear-gradient(".concat(a.deg,", ").concat(e[0]," 16%, ").concat(e[1]," 77%, ").concat(e[2]," 100%)")};var tt=Qe,at=Object(u.a)((function(e){return{registerButton:{color:e.palette.secondary.light}}}));function nt(e){var t=at(),a=Object(s.b)(),c=Object(n.useRef)(null),o=h().addAlert,u=Object(s.c)((function(e){return e.account.username})),m=Object(s.c)((function(e){return e.account.profile.displayName})),d=Object(n.useState)(""),f=Object(i.a)(d,2),p=f[0],b=f[1],g=Object(n.useState)(!0),v=Object(i.a)(g,2),E=v[0],j=v[1],O=Object(n.useState)(!1),w=Object(i.a)(O,2),x=w[0],N=w[1],S=Object(n.useState)(null),I=Object(i.a)(S,2),M=I[0],T=I[1],P=Object(n.useState)(!1),D=Object(i.a)(P,2),B=D[0],A=D[1],R=Object(n.useState)(!1),W=Object(i.a)(R,2),L=W[0],_=W[1],z=Object(n.useCallback)(Object(C.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A(!0),U({username:u,password:p}).then(function(){var e=Object(C.a)(k.a.mark((function e(t){var n,r,c,o,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.userId,a(Q(n)),a(ee(r)),e.next=5,q({userId:r});case 5:if(c=e.sent,o=c.spotifyLinked,a(ae(o)),!o){e.next=11;break}return e.next=11,K();case 11:return e.next=13,F({userId:r});case 13:return i=e.sent,a(te(i)),e.abrupt("return");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){A(!1),j(!1)})).catch((function(e){console.error(e),o({text:"Invalid username or password",type:"snackbar",severity:"error"}),b(""),A(!1)}));case 2:case"end":return e.stop()}}),e)}))),[a,o,p,u,A]);Object(n.useEffect)((function(){!1===E&&N(!0)}),[E]),Object(n.useEffect)((function(){!0===x&&T(setTimeout((function(){a(X(!0))}),2500))}),[x,a]),Object(n.useEffect)((function(){return function(){clearTimeout(M)}}));var G=Object(n.useCallback)((function(){o({text:"Account successfully created!",severity:"success",type:"snackbar"}),_(!1)}),[o,_]),H=Object(n.useCallback)((function(e){13===e.keyCode&&z()}),[z]),Y=Object(n.useCallback)((function(e){13===e.keyCode&&c.current.focus()}),[c]),Z={textAlign:"center",paddingBottom:"10px"},V=r.a.createElement(r.a.Fragment,null,r.a.createElement(qe.a,{item:!0,style:Z},r.a.createElement(y.a,{variant:"subtitle1",style:{color:Qe.palette.text.hint}},"Welcome to"),r.a.createElement(y.a,{variant:"h3"},"Meetify")),r.a.createElement(qe.a,{item:!0,style:Z,xs:12},r.a.createElement(Ge.a,{label:"Username",value:u,onChange:function(e){return a(Q(e.target.value))},onKeyDown:Y,disabled:B})),r.a.createElement(qe.a,{item:!0,style:Z,xs:12},r.a.createElement(Ge.a,{label:"Password",type:"password",inputRef:c,autoComplete:"current-password",value:p,onChange:function(e){return b(e.target.value)},onKeyDown:H,disabled:B})),r.a.createElement(qe.a,{item:!0,style:Z,xs:12},r.a.createElement(ce.a,{disableElevation:!0,color:"primary",variant:"contained",onClick:z,disabled:B},B?r.a.createElement(Ke,null):"Login")),r.a.createElement(qe.a,{item:!0,style:Z,xs:12},r.a.createElement(ce.a,{disableElevation:!0,color:"secondary",onClick:function(){return _(!0)},className:t.registerButton,disabled:B},"Register"))),$=r.a.createElement(r.a.Fragment,null,r.a.createElement(qe.a,{item:!0,style:Z},r.a.createElement(y.a,{variant:"h3"},"Welcome, ",m||u||"user"))),J=Object(n.useRef)(null),ne=Object(n.useRef)(null);return r.a.createElement("div",{style:{height:"100%",width:"100%",position:"absolute"}},r.a.createElement(l.a,{classNames:"fade",timeout:500,unmountOnExit:!0,style:{position:"absolute",height:"100%",width:"100%"},nodeRef:J,in:E},r.a.createElement(qe.a,{style:{height:"100%",width:"100%",position:"relative"},justify:"center",alignContent:"center",container:!0,ref:J},V)),r.a.createElement(l.a,{classNames:"fade",timeout:500,unmountOnExit:!0,style:{position:"absolute",height:"100%",width:"100%"},nodeRef:ne,in:x},r.a.createElement(qe.a,{style:{height:"100%",width:"100%",position:"relative"},justify:"center",alignContent:"center",container:!0,ref:ne},$)),r.a.createElement(Ye,{open:L,onSuccess:G,onCancel:function(){return _(!1)}}))}var rt=a(206),ct=a(73),ot=a.n(ct),it=a(103),lt=a.n(it),st=a(47),ut=a(100),mt=a.n(ut),dt=Object(u.a)((function(e){return{button:{margin:e.spacing(1)},progress:{margin:e.spacing(1)+12}}}));function ft(e){var t=dt(),a=e.loading,n=Object(st.a)(e,["loading"]),c=a&&r.a.createElement("div",{className:t.progress},r.a.createElement(Ke,null))||r.a.createElement(g.a,Object.assign({"aria-label":"refresh"},n,{className:t.button}),r.a.createElement(mt.a,null));return r.a.createElement("div",{className:e.className},c)}var pt=a(198),ht=a(199),bt=a(200),gt=a(201),vt=a(71),yt=a.n(vt),Et=a(72),jt=a.n(Et),Ot=a(217);function kt(e){e||(e={});var t=e.className,a=t?{className:t}:{},n=e,c=n.displayName,o=Object(st.a)(n,["displayName"]),i=c?c[0].toUpperCase():void 0;return r.a.createElement(Ot.a,Object.assign({},o,{imgProps:a}),i)}var wt=Object(u.a)((function(e){return{root:{height:"100%",width:"100%"},refresh:{position:"absolute",right:0,top:0},closeButton:{color:e.palette.error.light,marginRight:"auto"}}}));function Ct(e){var t=wt(),a=e.closeButtonDisabled,n=e.onCloseClick,c=e.songButtonDisabled,o=e.onSongsClick,i=e.actionButtonDisabled,l=e.onActionClick,s=e.actionButtonIcon;return r.a.createElement(pt.a,{disableSpacing:!0},r.a.createElement(g.a,{className:t.closeButton,onClick:n,disabled:a},r.a.createElement(yt.a,null)),r.a.createElement(g.a,{onClick:o,disabled:c},r.a.createElement(jt.a,null)),r.a.createElement(g.a,{color:"primary",onClick:l,disabled:i},s))}var xt=r.a.memo(Ct);function Nt(e){var t=wt(),a=e.user,n=e.closeButtonDisabled,c=e.onCloseClick,o=e.songButtonDisabled,i=e.onSongsClick,l=e.actionButtonDisabled,s=e.onActionClick,u=e.actionButtonIcon,m=e.onProfileClick,d=e.className,f=Object(st.a)(e,["user","closeButtonDisabled","onCloseClick","songButtonDisabled","onSongsClick","actionButtonDisabled","onActionClick","actionButtonIcon","onProfileClick","className"]),p={closeButtonDisabled:n,onCloseClick:c,songButtonDisabled:o,onSongsClick:i,actionButtonDisabled:l,onActionClick:s,actionButtonIcon:u};return r.a.createElement("div",{className:d},r.a.createElement(ht.a,Object.assign({className:t.root,raised:!0},f),r.a.createElement(bt.a,{onClick:m},r.a.createElement(gt.a,{avatar:r.a.createElement(kt,{src:a.profile.profilePicUrl,displayName:a.profile.displayName}),title:a.profile.displayName})),r.a.createElement(xt,p)))}var St=function(e,t){var a={run:!0,ref:null},n=function(){var r=Object(C.a)(k.a.mark((function r(){return k.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a.run){r.next=2;break}return r.abrupt("return");case 2:e().then((function(){a.ref=setTimeout(n,t)})).catch((function(){It(a)}));case 3:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return n(),a},It=function(e){e.run=!1,clearTimeout(e.ref)},Mt=a(204),Tt=Object(u.a)((function(e){return{root:{height:"100%",width:"100%",padding:e.spacing(1)},primaryColor:{backgroundColor:e.palette.primary.dark},secondaryColor:{backgroundColor:e.palette.background.default},text:{whiteSpace:"pre"},date:{color:e.palette.text.hint}}}));function Pt(e){var t=Tt(),a=e.text,n=e.date,c="secondary"===e.color?t.secondaryColor:t.primaryColor;return r.a.createElement(d.a,{className:"".concat(t.root," ").concat(c),elevation:1},r.a.createElement("div",null,r.a.createElement(y.a,{variant:"body2",className:t.text},a)),r.a.createElement("div",null,r.a.createElement(y.a,{variant:"caption",className:t.date},function(e){return"".concat(function(e){var t=e.toDateString().match(/.+ [0-9]+ [0-9]+/);return t.length>0?t[0]:"(no date)"}(e)," ").concat(function(e){var t=e.toTimeString().match(/[0-9]+:[0-9]+/);return t.length>0?t[0]:"(no time)"}(e))}(n))))}var Dt=a(101),Bt=a.n(Dt),At=Object(u.a)((function(e){return{root:{display:"flex",width:"100%",height:"100%",alignItems:"center"},textField:{flexGrow:1,marginRight:e.spacing(1)}}}));function Rt(e){var t=At(),a=Object(n.useRef)(null),c=h().addAlert,o=Object(n.useState)(""),l=Object(i.a)(o,2),s=l[0],u=l[1],m=Object(n.useState)(!1),d=Object(i.a)(m,2),f=d[0],p=d[1],b=e.placeholder,v=e.userTo,y=Object(n.useCallback)((function(e){p(!0),function(e){var t=e.userTo,a=e.text,n=R.apply(void 0,[D].concat(Object(w.a)(B.messages))),r={ToUserID:t,Text:a};return N.a.post(n,r).then((function(e){if(e.status>=300)throw Error("Received status ".concat(e.status," from server"))})).catch((function(e){throw e}))}({userTo:v,text:e}).then((function(){u(""),p(!1),a.current.focus()})).catch((function(e){console.error(e),c({type:"snackbar",severity:"error",text:"Could not send message. Please try again."}),p(!1),a.current.focus()}))}),[v,c]);return r.a.createElement("div",{className:t.root},r.a.createElement(Ge.a,{className:t.textField,variant:"outlined",placeholder:b||"Message",multiline:!0,value:s,rowsMax:4,autoFocus:!0,onChange:function(e){var t=e.target.value;t.length>s.length&&t.endsWith("\n")||u(t)},onKeyDown:function(e){var t=13===e.keyCode,a=e.shiftKey;t&&(a?u(s+"\n"):y(s))},disabled:f,inputRef:a}),r.a.createElement("div",null,r.a.createElement(g.a,{onClick:function(){return y(s)}},r.a.createElement(Bt.a,null))))}var Ut=Object(u.a)((function(e){return{root:{width:"100%",height:"100%",display:"flex",flexDirection:"column-reverse",position:"relative"},inputContainer:{width:"100%"},chatContainer:{display:"flex",flexGrow:1,width:"100%",height:"100%",flexDirection:"column",overflow:"auto",marginBottom:e.spacing(1)},chat:{display:"flex",width:"100%"},chatBubble:{maxWidth:"60%",marginBottom:e.spacing(1)},chatRight:{justifyContent:"flex-end"},chatLeft:{justifyContent:"flex-start"}}}));function Wt(e){var t=Ut(),a=e.otherUser,n=a.messages,c=a.profile,o=a.userId,i=c&&c.displayName?c.displayName.split(" ")[0]:"Matched User",l="Message ".concat(i),s=(n||[]).map((function(e,a){var n=e.senderUserId===o,c=n?t.chatLeft:t.chatRight,i=n?"secondary":"primary";return r.a.createElement("div",{className:"".concat(t.chat," ").concat(c),key:a},r.a.createElement("div",{className:t.chatBubble},r.a.createElement(Pt,{color:i,text:e.text,date:e.date,left:n,right:!n})))}));return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.inputContainer},r.a.createElement(Rt,{placeholder:l,userTo:o})),r.a.createElement("div",{className:t.chatContainer},s))}var Lt=a(202),Ft=a(102),_t=a.n(Ft),zt=Object(u.a)((function(e){return{dialogContent:{maxWidth:600,minWidth:600,paddingTop:e.spacing(2)},cancelButton:{color:e.palette.error.light},saveButton:{color:e.palette.primary.light},editableMargin:{marginTop:e.spacing(2)},avatarRow:{display:"flex",alignItems:"center"},avatarTextField:{marginLeft:e.spacing(2)},avatar:{width:e.spacing(6),height:e.spacing(6)}}}));function qt(e){var t=e.open,a=e.onCancel,c=e.onSave,o=e.profile||{},l=o.description,s=o.displayName,u=o.profilePicUrl,m=zt(),d=Object(n.useState)(null),f=Object(i.a)(d,2),p=f[0],h=f[1],b=Object(n.useState)(null),g=Object(i.a)(b,2),v=g[0],y=g[1],E=null!==v&&0===v.length;Object(n.useEffect)((function(){!0===t&&(h(null),y(null))}),[t]);return r.a.createElement(pe,{open:t,title:"Edit Profile",submitButtonText:"Save Changes",submitButtonDisabled:E,onSubmit:function(){if(c){var e={};null!==p&&(e.description=p.trim()),null!==v&&(e.displayName=v.trim()),c(e)}},onClose:function(){return a&&a()},onCancel:function(){return a&&a()}},r.a.createElement("span",{className:m.avatarRow},r.a.createElement(kt,{className:m.avatar,src:u,displayName:null!==v?v:s}),r.a.createElement(Ge.a,{className:m.avatarTextField,fullWidth:!0,disabled:!0,variant:"outlined",label:"Profile Picture",value:"(This is pulled from your Spotify account)"})),r.a.createElement(Ge.a,{className:m.editableMargin,label:"Display Name",variant:"outlined",error:E,helperText:E&&"Must be defined!",fullWidth:!0,required:!0,placeholder:"What should we call you?",value:null!==v?v:s,onChange:function(e){return y(e.target.value)},inputProps:{maxLength:18}}),r.a.createElement(Ge.a,{className:m.editableMargin,label:"Personal Description",variant:"outlined",fullWidth:!0,multiline:!0,placeholder:"Tell us about yourself!",rowsMax:6,value:null!==p?p:l,onChange:function(e){return h(e.target.value)}}))}a(146);var Gt="8px",Ht=Qe.getGradient([Qe.palette.background.default,Qe.palette.primary.dark]),Yt=Qe.getGradient([Qe.palette.background.default,Qe.palette.secondary.dark]),Kt=Object(u.a)((function(e){return{description:{whiteSpace:"pre"},hintText:{color:e.palette.text.hint}}})),Zt=Qe.images.squareImageHeight;function Vt(e){var t=Kt(),a=Object(s.b)(),c=h().addAlert,o=Object(s.c)((function(e){return e.account.userId})),l=e.username,u=e.profile,m=e.editable,d=Object(n.useState)(!1),f=Object(i.a)(d,2),p=f[0],b=f[1],g=Object(n.useCallback)((function(){b(!0)}),[]),v=Object(n.useCallback)((function(){b(!1)}),[]),E=Object(n.useCallback)((function(e){_({userId:o,changes:e}).then((function(e){return a(te(e))})).then((function(){return b(!1)})).then((function(){return c({text:"Profile updated",severity:"success",type:"snackbar"})})).catch((function(e){c({title:e.name,text:e.message||"Could not profile. Please try again.",severity:"error",type:"dialog"})}))}),[o,a,c]),j=function(){return r.a.createElement(ht.a,{style:{width:"100%",background:Ht}},r.a.createElement(qe.a,{container:!0,justify:"center",align:"center",style:{width:"100%",margin:0}},r.a.createElement(qe.a,{item:!0,container:!0,xs:10},r.a.createElement(ht.a,{style:{width:Zt,margin:Gt,display:"inline-flex"}},r.a.createElement(Lt.a,{image:u.profilePicUrl,title:l+"'s profile picture",style:{height:Zt,width:Zt}})),r.a.createElement("span",{style:{textAlign:"left",margin:Gt,display:"inline-flex",alignItems:"center",flexGrow:1}},r.a.createElement("div",{style:{flexGrow:1}},r.a.createElement(y.a,{variant:"h5"},u.displayName)),m&&r.a.createElement(ce.a,{startIcon:r.a.createElement(_t.a,null),variant:"outlined",onClick:g},"Edit Profile")))))},O=function(){return r.a.createElement(qe.a,{container:!0,justify:"center",align:"center",style:{width:"100%",margin:0}},r.a.createElement(qe.a,{item:!0,container:!0,xs:10},r.a.createElement(ht.a,{style:{width:"100%",margin:Gt,padding:Gt,textAlign:"left"}},r.a.createElement(y.a,{variant:"h6"},"Personal Description"),r.a.createElement(y.a,{variant:"body1",className:"".concat(t.description," ").concat(u.description?"":t.hintText)},u.description||"(no description)"))))};return r.a.createElement("div",{style:{width:"100%",alignItems:"middle"}},r.a.createElement(ht.a,{style:{padding:0,maxWidth:"700px",margin:"auto",background:Yt}},r.a.createElement(j,null),r.a.createElement(O,null)),r.a.createElement(qt,{open:p,onCancel:v,onSave:E,profile:u}))}var $t=a(203),Jt=Object(u.a)((function(e){return{root:{display:"flex",height:"100%",width:"100%"},media:{height:"100%",width:"auto"},contents:{height:"100%",display:"flex",alignItems:"center"},subText:{color:e.palette.text.secondary}}}));function Xt(e){var t=Jt();return r.a.createElement(ht.a,{className:t.root,raised:!0},r.a.createElement(Lt.a,{image:e.albumArtUrl,title:e.album+" album cover",className:t.media,component:"img"}),r.a.createElement("div",{className:t.contents},r.a.createElement($t.a,null,r.a.createElement(y.a,{variant:"h6"},e.song),r.a.createElement(y.a,{variant:"subtitle1",className:t.subText},e.artist),r.a.createElement(y.a,{variant:"caption",className:t.subText},e.album))))}var Qt=Object(u.a)((function(e){return{root:{height:"100%",width:"100%"},songTile:{height:e.tile.height,width:"100%",padding:e.spacing(1)}}})),ea=r.a.memo((function(e){var t=e.songs,a=Qt();return t.map((function(e,t){return r.a.createElement("div",{className:a.songTile,key:t},r.a.createElement(Xt,{song:e.song,artist:e.artist,albumArtUrl:e.albumArtUrl}))}))})),ta=Object(u.a)((function(e){return{root:{height:"100%",width:"100%",position:"relative"},contents:{padding:e.spacing(3),paddingTop:60+e.spacing(3),height:"100%",overflow:"auto"},appBar:{position:"absolute",top:0},title:{flexGrow:1},hintText:{color:e.palette.text.hint}}}));function aa(e){var t=ta(),a=e.onCloseClick,c=e.user,o=e.defaultTab,l=e.chatHidden,s=e.refreshMethod,u=c.songs,f=c.profile,p=c.username,h=c.matchId,v=[{val:"profile",icon:r.a.createElement(We.a,null),component:r.a.createElement(Vt,{username:p,profile:f})},{val:"songs",icon:r.a.createElement(jt.a,null),component:u&&0!==u.length?r.a.createElement(ea,{songs:u}):r.a.createElement(y.a,{variant:"subtitle1",className:t.hintText},"No matching songs found")},{val:"chat",icon:r.a.createElement(ot.a,null),component:r.a.createElement(Wt,{otherUser:c})}].filter((function(e){return!("chat"===e.val&&l)}));Object(n.useEffect)((function(){if(s){var e=St((function(){return s({matchId:h})}),1e3);return function(){It(e)}}}),[s,h]);var E=o&&v.findIndex((function(e){return e.val===o}))||0,j=Object(n.useState)(E),O=Object(i.a)(j,2),k=O[0],w=O[1];Object(n.useEffect)((function(){w(E)}),[E]);var C=v[k].component;return r.a.createElement(d.a,{className:t.root,elevation:5},r.a.createElement(se.a,{className:t.appBar,elevation:1},r.a.createElement(Mt.a,null,r.a.createElement(y.a,{variant:"h6",className:t.title},c.profile.displayName),r.a.createElement(b.a,{value:k,textColor:"inherit",className:t.tabs},v.map((function(e,a){return r.a.createElement(m.a,{key:e.val,label:e.val,icon:e.icon,onClick:function(){return w(a)},className:t.tab})}))),r.a.createElement(g.a,{color:"inherit",onClick:a},r.a.createElement(yt.a,null)))),r.a.createElement("div",{className:t.contents},C))}function na(e){var t=e.open,a=e.onCancel,n=e.onSubmit;return r.a.createElement(pe,{open:t,title:"Match Dismiss",submitButtonText:"Dismiss",onSubmit:function(){return n&&n()},onClose:function(){return a&&a()},onCancel:function(){return a&&a()}},r.a.createElement(y.a,{variant:"body1"},"Are you sure you want to dismiss this user? You will lose access to all prior chat history.",r.a.createElement("br",null),r.a.createElement("strong",null,"This cannot be undone.")))}var ra=Object(u.a)((function(e){return{root:{height:"100%",width:"100%",position:"relative"},card:{margin:e.spacing(1),minWidth:200,maxWidth:275},refresh:{position:"absolute",right:0,top:0},userView:{height:"100%",width:"100%",position:"absolute",top:0},matchesView:{height:"100%",width:"100%",paddingRight:50,position:"relative"},hintText:{color:e.palette.text.hint,margin:e.spacing(1)}}}));function ca(e){var t=ra(),a=h().addAlert,c=e.inMeetMode,o=e.matches,l=e.onRefreshClick,s=e.loading,u=e.refreshMethod,m=e.useDismissWarningDialog,d=e.onChange,f=Object(n.useState)(null),p=Object(i.a)(f,2),b=p[0],g=p[1],v=Object(n.useState)(null),E=Object(i.a)(v,2),j=E[0],O=E[1],k=Object(n.useState)(!1),C=Object(i.a)(k,2),x=C[0],S=C[1],I=Object(n.useState)(null),M=Object(i.a)(I,2),T=M[0],P=M[1],A=null!=j?o[j]:null,U=Object(n.useCallback)((function(e){g("chat"),O(e)}),[g,O]),W=Object(n.useCallback)((function(e){g("profile"),O(e)}),[g,O]),L=Object(n.useCallback)((function(e){g("songs"),O(e)}),[g,O]),F=Object(n.useCallback)((function(){O(null)}),[O]),_=Object(n.useCallback)((function(e){(function(e){var t=e.matchId,a=R.apply(void 0,[D].concat(Object(w.a)(B.acceptMatch))),n={match_id:t};return N.a.post(a,n).then((function(e){if(e.status>=300)throw Error("Received status ".concat(e.status," from server"))})).catch((function(e){throw e}))})({matchId:e.matchId}).then((function(){a({type:"snackbar",severity:"success",text:"Match accepted"}),d&&d()})).catch((function(e){console.error(e),a({type:"snackbar",severity:"error",text:"Could not accept match"})}))}),[a,d]),z=Object(n.useCallback)((function(e){var t=e.matchId,n=function(){(function(e){var t=e.matchId,a=R.apply(void 0,[D].concat(Object(w.a)(B.rejectMatch))),n={match_id:t};return N.a.post(a,n).then((function(e){if(e.status>=300)throw Error("Received status ".concat(e.status," from server"))})).catch((function(e){throw e}))})({matchId:t}).then((function(){a({type:"snackbar",severity:"info",text:"Match dismissed"}),d&&d()})).catch((function(e){console.error(e),a({type:"snackbar",severity:"error",text:"Could not dismiss match"})}))};m?(P((function(){return function(){n(),S(!1)}})),S(!0)):n()}),[P,S,m,a,d]),q=Object(n.useCallback)((function(){S(!1),P(null)}),[S,P]),G=o&&0!==o.length?o.map((function(e,a){return r.a.createElement(Nt,{key:a,className:t.card,user:e,onActionClick:function(){return c?_(e):U(a)},onProfileClick:function(){return W(a)},onCloseClick:function(){return z(e)},onSongsClick:function(){return L(a)},actionButtonIcon:c?r.a.createElement(lt.a,null):r.a.createElement(ot.a,null)})})):r.a.createElement(y.a,{variant:"h6",className:t.hintText},"No matches yet!"),H=r.a.createElement("div",{className:t.userView},r.a.createElement(aa,{onCloseClick:F,user:A,defaultTab:b,chatHidden:c,refreshMethod:u})),Y=r.a.createElement("div",{className:t.matchesView},r.a.createElement(qe.a,{container:!0,alignItems:"flex-start",justify:"flex-start"},G),r.a.createElement(ft,{onClick:function(){return l&&l()},loading:s,className:t.refresh}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.root},Y,A&&H),r.a.createElement(na,{open:x,onSubmit:function(){return T&&T()},onCancel:function(){return q()}}))}var oa=70/1.5,ia=Object(u.a)((function(e){return{button:{height:70},buttonProgress:{color:e.palette.primary.main,position:"absolute",top:"50%",left:"50%",marginLeft:-oa/2,marginTop:-oa/2},initContainer:{display:"flex",height:"100%",width:"100%"},tile:{height:e.tile.height,width:"100%",padding:"8px"}}}));function la(){var e=ia(),t=Object(s.b)(),a=h().addAlert,c=Object(s.c)((function(e){return e.meet.matches})),o=c&&c.length>0,l=Object(n.useState)(o),u=Object(i.a)(l,2),m=u[0],d=u[1],f=Object(n.useState)(!1),p=Object(i.a)(f,2),b=p[0],g=p[1],v=Object(n.useState)(!1),E=Object(i.a)(v,2),j=E[0],O=E[1],k=Object(n.useState)(!1),C=Object(i.a)(k,2),x=C[0],N=C[1],S=null;function I(){O(!0),g(!0),function(){var e=R.apply(void 0,[D].concat(Object(w.a)(B.getPotentialMatches)));return H(e)}().then((function(e){t(Te(e)),N(!0),S=setTimeout((function(){d(!0),N(!1),O(!1)}),2e3)})).catch((function(e){console.error(e),a({type:"snackbar",severity:"error",text:"Could not retrieve potential matches"}),d(!1),N(!1),O(!1),t(Pe())})).finally((function(){g(!1)}))}Object(n.useEffect)((function(){return function(){clearTimeout(S)}}));var M=r.a.createElement("div",{className:e.initContainer},r.a.createElement(qe.a,{justify:"center",alignContent:"center",container:!0},r.a.createElement(ce.a,{variant:"contained",className:e.button,size:"large",color:"primary",disabled:j,onClick:I},r.a.createElement(y.a,{variant:"h4"},"Meetify!"),b&&!x&&r.a.createElement(oe.a,{className:e.buttonProgress,size:oa}),x&&r.a.createElement(rt.a,{className:e.buttonProgress,style:{fontSize:oa}}))));return m?r.a.createElement(ca,{inMeetMode:!0,matches:c,loading:b,onRefreshClick:I,onChange:function(){return I()}}):M}function sa(e){var t=Object(s.b)(),a=h().addAlert,c=Object(n.useRef)(null),o=Object(n.useState)(!1),l=Object(i.a)(o,2),u=l[0],m=l[1],d=Object(s.c)((function(e){return e.intersect.username})),f=Object(s.c)((function(e){return e.intersect.songs})),p=!d||u,b=u,g=function(){p||(t(Ee([])),m(!0),Y({username:d}).then((function(e){m(!1),t(Ee(e))})).catch((function(e){m(!1),console.error(e),a({type:"snackbar",severity:"error",text:"Could not retrieve songs. Make sure the username is correct and try again!"})})).finally((function(){c.current.focus()})))};return r.a.createElement("div",null,r.a.createElement(qe.a,{container:!0,alignItems:"center",spacing:2},r.a.createElement(qe.a,{item:!0},r.a.createElement(Ge.a,{label:"Other User's Username",variant:"outlined",value:d,disabled:b,onChange:function(e){return t(ye(e.target.value))},onKeyDown:function(e){13===e.keyCode&&g()},inputRef:c,autoFocus:!0})),r.a.createElement(qe.a,{item:!0},r.a.createElement(ce.a,{variant:"contained",disableElevation:!0,color:"primary",disabled:p,onClick:function(){return g()}},u?r.a.createElement(Ke,null):"Submit"))),r.a.createElement("div",null,r.a.createElement(ea,{songs:f})))}function ua(e){var t=Object(s.b)(),a=h().addAlert,c=Object(s.c)((function(e){return e.matches.matches})),o=Object(n.useState)(!1),l=Object(i.a)(o,2),u=l[0],m=l[1],d=Object(n.useCallback)((function(e){return m(!0),function(){var e=R.apply(void 0,[D].concat(Object(w.a)(B.getAcceptedMatches)));return H(e)}().then((function(e){t(Ce(e))})).catch((function(e){throw console.error(e),a({type:"snackbar",severity:"error",text:"Could not load matches"}),e})).finally((function(){m(!1)}))}),[t,a]);Object(n.useEffect)((function(){d()}),[d]);var f=Object(n.useCallback)((function(e){var n=e.matchId;return console.info("Refreshing match ".concat(n," data...")),function(e){var t=e.matchId,a=R.apply(void 0,[D].concat(Object(w.a)(B.messages))).replace("{match_id}",t);return N.a.get(a).then((function(e){if(e.status>=300)throw Error("Received status ".concat(e.status," from server"));if(e.data)return e.data.map((function(e){return{matchId:e.MatchId,senderUserId:e.SenderUserId,text:e.Text.replaceAll("\\n","\n"),date:new Date(e.META_StartDate)}}));throw Error("Received no messages from server")})).catch((function(e){throw e}))}({matchId:n}).then((function(e){t(xe({matchId:n,messages:e}))})).catch((function(e){throw console.error(e),a({type:"snackbar",severity:"error",text:"Could not load messages"}),e}))}),[t,a]);return r.a.createElement(ca,{matches:c,loading:u,onRefreshClick:d,refreshMethod:f,onChange:function(){return d()},useDismissWarningDialog:!0})}a(147);var ma=Object(u.a)((function(e){return{tabBar:{float:"left",maxWidth:"25%",height:"100%"}}}));function da(){var e=ma(),t=Object(s.c)((function(e){return e.account.loggedIn})),a=Object(s.c)((function(e){return e.account.username})),c=Object(s.c)((function(e){return e.account.profile})),o=[{label:"Meet",val:"meet",component:r.a.createElement(la,null)},{label:"Matches",val:"matches",component:r.a.createElement(ua,null)},{label:"Intersect",val:"intersect",component:r.a.createElement(sa,null)},{label:"Profile",val:"profile",component:r.a.createElement(Vt,{username:a,profile:c,editable:!0})}],u=o[0].val,f=Object(n.useState)(u),p=Object(i.a)(f,2),h=p[0],b=p[1],g=o.map((function(e){return r.a.createElement(m.a,{key:e.val,label:e.label,onClick:function(){return b(e.val)}})})),v=o.find((function(e){return e.val===h})).component,y=o.findIndex((function(e){return e.val===h})),E=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:e.tabBar},r.a.createElement(ze,{activeIndex:y},g)),r.a.createElement("div",{className:"main-container"},v)),j=Object(n.useRef)(null),O=Object(n.useRef)(null);return r.a.createElement(d.a,{className:"app-root",square:!0,style:{position:"relative"}},r.a.createElement(l.a,{classNames:"fade",timeout:500,unmountOnExit:!0,style:{position:"absolute",height:"100%",width:"100%"},nodeRef:j,in:!t},r.a.createElement("div",{ref:j},r.a.createElement(nt,null))),r.a.createElement(l.a,{classNames:"fade",timeout:500,unmountOnExit:!0,style:{position:"absolute",height:"100%",width:"100%"},nodeRef:O,in:t},r.a.createElement("div",{ref:O},r.a.createElement("div",{style:{display:"flex",height:"100%",width:"100%"}},E))))}var fa=a(56),pa=Object(Z.a)({reducer:{account:re,intersect:Oe,meet:De,matches:Se},middleware:[fa.a]}),ha=(a(148),a(149),a(208)),ba=a(209),ga=a(216),va=a(207),ya=["success","info","warning","error"];function Ea(){var e=Object(n.useContext)(f),t=e.alert,a=e.removeAlert,c=Object(n.useState)(!1),o=Object(i.a)(c,2),l=o[0],s=o[1],u=Object(n.useState)([]),m=Object(i.a)(u,2),d=m[0],p=m[1];Object(n.useEffect)((function(){t&&!d.includes(t)&&(a(t),p([].concat(Object(w.a)(d),[t])))}),[t,d,a]),Object(n.useEffect)((function(){d.length>0&&s(!0)}),[d,s]);var h=function(){p(d.slice(1))};if(0===d.length)return r.a.createElement("div",null);var b,g=d[0],v=ya.includes(g.severity)&&g.severity||"info",y={severity:v,title:g.title||(b=v,b.split().map((function(e){var t=Object(S.a)(e),a=t[0],n=t.slice(1);return a.toUpperCase()+n.join("")})).join(" ")),text:g.text||"(no details)",type:["dialog","snackbar"].includes(g.type)?g.type:"snackbar"};return"snackbar"===y.type?r.a.createElement(ga.a,{autoHideDuration:6e3,open:l,onClose:function(){return s(!1)},onExited:h,color:"error"},r.a.createElement(ie.a,{severity:y.severity,onClose:function(){return s(!1)}},y.text)):r.a.createElement(le.a,{open:l,onClose:function(){return s(!1)},onExited:h,maxWidth:"sm"},r.a.createElement(ie.a,{severity:y.severity,onClose:function(){return s(!1)}},r.a.createElement(va.a,null,y.title),y.text))}o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ha.a,null),r.a.createElement(ba.a,{theme:tt},r.a.createElement(p,null,r.a.createElement(s.a,{store:pa},r.a.createElement(da,null)),r.a.createElement(Ea,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[150,1,2]]]);
//# sourceMappingURL=main.65908ca8.chunk.js.map